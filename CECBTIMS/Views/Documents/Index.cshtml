@using System.Web.UI.WebControls
@using CECBTIMS.Models
@using DocumentFormat.OpenXml.Office2013.Excel
@model IEnumerable<CECBTIMS.Models.TimsFile>

@{
    ViewBag.Title = "Documents";
    Layout = "~/Views/Shared/_Layout.cshtml";
}






<div class="col-8 mx-auto mb-lg-5">
    <div class="card border-primary mb-3">
        <div class="card-header">
            Select a Template To Generate a Document
        </div>
        <div class="card-body">
            <div class="container pt-4 pb-4">
                @using (Html.BeginForm($"Generate", $"Documents", null, FormMethod.Get, new {}))
                {
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                    <div class="form-group">
                        <select class="custom-select" name="templateId">
                            
                            @foreach (TimsFile item in ViewBag.TemplateList)
                            {
                                <option value="@(item.Id)">@(item.Title)</option>
                            }

                        </select>
                    </div>
                    //this adds in the column select
                    <input type="hidden" name="title" value=""/>
                    <input type="hidden" name="details" value="GeneratedDocument"/>
                    <input type="hidden" name="ProgramType" value="@(ViewBag.program.ProgramType)"/>
                                                                                                  
                    <div class="form-group">
                        <input type="submit" value="Generate" class="btn btn-primary" />
                    </div>
                }

                @ViewBag.Message
            </div>
        </div>
    </div>
</div>




select columns here if hasTraee table true







<h2>View List</h2>


<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Program.Title)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Title)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Details)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ProgramType)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.FileName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.OriginalFileName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.FileType)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.FileMethod)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CreatedAt)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UpdatedAt)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CreatedBy)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UpdatedBy)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.RowVersion)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Program.Title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Details)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ProgramType)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.FileName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.OriginalFileName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.FileType)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.FileMethod)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CreatedAt)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UpdatedAt)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CreatedBy)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UpdatedBy)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.RowVersion)
        </td>

        
    </tr>
}

</table>
